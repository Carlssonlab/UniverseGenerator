//
std::vector<std::pair<unsigned int, unsigned int>> determine_bond_activation(const RDKit::ROMol &mol, const RDKit::Bond &bond,\
                                                                             std::unordered_set<std::string> &seen_activations)
{
    //
    std::vector<std::pair<unsigned int, unsigned int>> operators = {};

    // Get the atoms forming the bond
    const RDKit::Atom *bond_bgn = bond.getBeginAtom();

    // Iterate over all neighboring atoms
    for(const auto &neighbor_atom: mol.atomNeighbors(bond_bgn))
    {
        // Get the atomic number of the neighbor
        const unsigned int neighbor_atom_elem = neighbor_atom->getAtomicNum();

        // Is the neighbor an activation tag
        if (activation_types.count(neighbor_atom_elem) > 0)
        {
            // Get the atomic index of the neighbor
            const unsigned int neighbor_idx = neighbor_atom->getIdx();

            // Get the isotope
            const unsigned int neighbor_isotope = neighbor_atom->getIsotope();

            //
            std::string activation = std::to_string(neighbor_isotope) + "_" + std::to_string(neighbor_atom_elem);

            //
            if (seen_activations.count(activation) == 0)
            {
                // Store a pair with the obtained info
                operators.emplace_back(std::make_pair(neighbor_idx, neighbor_atom_elem));

                //
                seen_activations.emplace(activation);
            }
            
        }   
    }
    return operators;
}
